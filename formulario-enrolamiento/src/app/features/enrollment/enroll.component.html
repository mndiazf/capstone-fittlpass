<section class="page">
  <h1 class="title">Enrolar</h1>

  <div class="card enroll-card">
    <!-- Cámara -->
    <div class="camBox">
      <video #video autoplay playsinline muted></video>
      <canvas #guide></canvas>
      <div #ring class="ring"></div>
    </div>

    <!-- Barra inferior -->
    <div class="bar">
      <!-- Consentimiento -->
      <label class="check">
        <input type="checkbox" formControlName="acepta">
        <span>He leído y acepto las
          <a href="/politica-biometrica" target="_blank">políticas biométricas</a>
        </span>
      </label>

      <!-- Acciones cámara -->
      <div class="buttons">
        <button class="btn violet" type="button" (click)="startCam()" [disabled]="camReady()">Activar cámara</button>
        <button class="btn violet" type="button" (click)="capture()" [disabled]="!camReady() || !guideOk()">Capturar</button>
        <button class="btn violet ghost" type="button" (click)="resetShot()" [disabled]="!preview()">Limpiar</button>
      </div>

      <!-- CTA principal -->
      <button class="btn teal wide"
              type="button"
              (click)="onSubmit()"
              [disabled]="loading() || !preview() || f.invalid">
        Enrolar
      </button>
    </div>

    <!-- Estado -->
    <div [class.ok]="guideOk()" class="status" aria-live="polite">
      <span class="dot"></span>
      <span>{{ guideMsg() }}</span>
    </div>

    <!-- (Opcional) mini preview si quieres mostrarla -->
    <div *ngIf="preview()" class="preview">
      <img [src]="preview()!" alt="captura" />
    </div>

    <div class="msg" *ngIf="msg()">{{ msg() }}</div>
  </div>
</section>
