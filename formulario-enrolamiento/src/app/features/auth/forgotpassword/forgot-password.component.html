<div class="login-overlay" *ngIf="visible" (click)="onBackdrop($event)" (keydown.escape)="closeModal()">
  <div class="login-box" role="dialog" aria-modal="true" (click)="$event.stopPropagation()">
    <button class="close" type="button" aria-label="Cerrar" (click)="closeModal()">✕</button>

    <img src="assets/logo-gymhealth.png" alt="GymHealth" class="logo" />
    <h2 class="welcome">¿Olvidó su contraseña?</h2>

    <div class="yellow-frame">
      <form [formGroup]="f" (ngSubmit)="onSubmit()" novalidate>
        <input
          type="email"
          formControlName="email"
          placeholder="Ingrese su correo electrónico"
          [class.invalid]="email?.touched && email?.invalid"
          [attr.aria-invalid]="email?.touched && email?.invalid ? true : null"
          autocomplete="email" inputmode="email" autofocus
        />
        <div class="error" *ngIf="email?.touched && email?.invalid">
          <small *ngIf="email?.errors?.['required']">El correo es obligatorio</small>
          <small *ngIf="email?.errors?.['email']">Formato de correo no válido</small>
          <small *ngIf="email?.errors?.['pattern']">Debe incluir un dominio válido (ej: .com, .cl)</small>
        </div>

        <button type="submit" [disabled]="f.invalid || sending">
          {{ sending ? 'Enviando…' : 'Restablecer contraseña' }}
        </button>

        <p class="success" *ngIf="sent">
          Si el correo existe, te enviaremos un enlace para restablecer tu contraseña.
        </p>
      </form>
    </div>

    <div class="extra-links">
      <a (click)="closeModal()">Volver a inicio de sesión</a>
    </div>
  </div>
</div>
