<!-- src/app/features/dashboard/dashboard.component.html -->

<div class="dashboard-wrapper">
  <div class="dashboard">
    <!-- Header -->
    <div class="dashboard__header">
      <h1 class="dashboard__title">Bienvenido a GymHealth</h1>
      <p class="dashboard__subtitle">
        Panel de Control - Resumen de hoy
        <span *ngIf="summary() as s"> ({{ s.date }})</span>
      </p>
    </div>

    <!-- Mensaje de error -->
    <div *ngIf="hasError()" class="dashboard__error">
      <mat-card>
        <div class="dashboard__error-content">
          <mat-icon>error_outline</mat-icon>
          <span>Ocurrió un error al cargar el dashboard. Intenta nuevamente.</span>
        </div>
      </mat-card>
    </div>

    <!-- Statistics Cards (basadas en el endpoint) -->
    <div class="dashboard__stats" *ngIf="!hasError()">
      <mat-card
        *ngFor="let stat of stats()"
        class="stat-card"
        [ngClass]="'stat-card--' + stat.color"
      >
        <div class="stat-card__header">
          <mat-icon class="stat-card__icon">{{ stat.icon }}</mat-icon>
          <span class="stat-card__badge">{{ stat.badge }}</span>
        </div>
        <h3 class="stat-card__value">{{ stat.value }}</h3>
        <p class="stat-card__label">{{ stat.label }}</p>
      </mat-card>
    </div>

    <!-- Recent Activity -->
    <div class="dashboard__content" *ngIf="!hasError()">
      <mat-card class="content-card">
        <div class="content-card__header">
          <h2 class="content-card__title">Actividad Reciente de Hoy</h2>
          <button
            mat-icon-button
            class="content-card__refresh"
            (click)="loadDashboardData()"
            [disabled]="isLoading()"
            aria-label="Actualizar actividad"
          >
            <mat-icon>refresh</mat-icon>
          </button>
        </div>

        <div class="activity-list" *ngIf="activities().length > 0; else noActivity">
          <div
            *ngFor="let activity of activities()"
            class="activity-item"
            [ngClass]="'activity-item--' + activity.type.toLowerCase()"
          >
            <div
              [ngClass]="
                'activity-item__icon activity-item__icon--' +
                activity.type.toLowerCase()
              "
            >
              <mat-icon>{{ activity.icon }}</mat-icon>
            </div>
            <div class="activity-item__content">
              <p class="activity-item__title">{{ activity.title }}</p>
              <p class="activity-item__time">
                {{ activity.subtitle }} ·
                {{ activity.timestamp | date: 'HH:mm' }}
              </p>
            </div>
          </div>
        </div>

        <ng-template #noActivity>
          <div class="activity-list activity-list--empty">
            <mat-icon>info</mat-icon>
            <p>No hay actividad registrada hoy todavía.</p>
          </div>
        </ng-template>
      </mat-card>
    </div>
  </div>
</div>
